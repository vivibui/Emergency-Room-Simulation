ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), vjust=-0.25, size = 5)
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), vjust=-0.25, size = 2)
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.1), vjust=-0.25, size = 2)
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), vjust=-0.5, size = 2)
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), hjust=-0.5, size = 2) +
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="PuBu") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), hjust=-0.5, size = 2) +
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="Set2") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), hjust=-0.5, size = 2) +
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="Blues") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), hjust=-0.5, size = 2) +
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), hjust=-0.5, size = 2) +
theme_minimal()
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=AcuteLv, y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score") +
dark_theme_minimal()
library(dplyr)
library(tidyverse)
library(ggdark)
library(ggplot2)
library(ggforce)
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=AcuteLv, y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score") +
dark_theme_minimal()
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=AcuteLv, y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score")
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=AcuteLv, y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score") +
theme_minimal()
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=factor(AcuteLv), y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score") +
scale_x_discrete(name = "Priority Group") +
theme_minimal()
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=factor(AcuteLv), y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score") +
scale_x_discrete(name = "Priority Group") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), vjust=-0.5, size = 2) +
theme_minimal()
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=factor(AcuteLv), y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score") +
scale_x_discrete(name = "Priority Group") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), vjust=-0.5, size = 10) +
theme_minimal()
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=factor(AcuteLv), y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score") +
scale_x_discrete(name = "Priority Group") +
geom_text(size = 3, aes(label=mean_SF),
position=position_dodge(width=0.9), vjust=-0.25)+
theme_minimal()
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=factor(AcuteLv), y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score") +
scale_x_discrete(name = "Priority Group") +
geom_text(size = 3, color = 'black', aes(label=mean_SF),
position=position_dodge(width=0.9), vjust=-0.25)+
theme_minimal()
# Compare the % of LWBS in each Priority Group across method
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")*100/n(),2),
.groups = 'drop')
# Compare the % of LWBS in each Priority Group across method
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS"),2),
.groups = 'drop')
# Compare the % of LWBS in each Priority Group across method
df_p %>% group_by(AcuteLv, Day, Method) %>%
summarise(percent = round(sum(mean(Time_A == "LWBS")),2),
.groups = 'drop')
# Compare the % of LWBS in each Priority Group across method
df_p %>% group_by(AcuteLv, Day_C, Method) %>%
summarise(percent = round(sum(mean(Time_A == "LWBS")),2),
.groups = 'drop')
# Compare the % of LWBS in each Priority Group across method
df_p %>% group_by(AcuteLv, Day_C, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS"),2),
.groups = 'drop')
# Compare the % of LWBS in each Priority Group across method
df_p %>% group_by(AcuteLv, Method) %>%
summarise(count = round(sum(Time_A == "LWBS"),2),
.groups = 'drop')
df_p %>% group_by(AcuteLv, Method) %>%
summarise(count = round(sum(Time_A != "LWBS"),2),
.groups = 'drop')
# Compare the % of LWBS in each Priority Group across method
df_p %>% group_by(AcuteLv, Method) %>%
summarise(count = round(sum(Time_A == "LWBS"),2),
.groups = 'drop')
df_p %>% group_by(AcuteLv, Method) %>%
summarise(count = round(sum(Time_A == "LWBS")/n(),2),
.groups = 'drop')
df_p %>% group_by(AcuteLv, Method) %>%
summarise(count = round(sum(Time_A == "LWBS")/n(),4),
.groups = 'drop')
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(count = round(sum(Time_A == "LWBS")/n(),2),
.groups = 'drop')
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")/n(),2), .groups = 'drop') %>%
ggplot(aes(x=Method, y=percent)) +
geom_col(width = 0.5, fill="steelblue") +
scale_y_continuous(name = "Percent of LWBS") +
scale_x_discrete(name = "Method") +
geom_text(size = 3, aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25) +
theme_minimal()
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")/n(),2), .groups = 'drop') %>%
ggplot(aes(x=AcuteLv, y=percent)) +
facet_wrap(vars(Method)) +
geom_col(width = 0.5, fill="steelblue") +
scale_y_continuous(name = "Percent of LWBS") +
scale_x_discrete(name = "Method") +
geom_text(size = 3, aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25) +
theme_minimal()
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")/n(),2), .groups = 'drop') %>%
ggplot(aes(x=AcuteLv, y=percent)) +
facet_wrap(vars(Method)) +
geom_col(width = 0.5, fill="steelblue") +
scale_y_continuous(name = "Percent of LWBS") +
scale_x_discrete(name = "Method") +
geom_text(size = 3, aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25)
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")/n(),2), .groups = 'drop') %>%
ggplot(aes(x=AcuteLv, y=percent)) +
facet_wrap(vars(Method)) +
geom_col(width = 0.5, fill="steelblue") +
scale_y_continuous(name = "Percent of LWBS") +
geom_text(size = 3, aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25)
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")/n(),2), .groups = 'drop') %>%
ggplot(aes(x=AcuteLv, y=percent)) +
facet_wrap(vars(Method)) +
geom_col(width = 0.5, fill="steelblue") +
scale_y_continuous(name = "Percent of LWBS") +
geom_text(size = 3, color = "black", aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25)
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")/n(),2), .groups = 'drop') %>%
ggplot(aes(x=AcuteLv, y=percent, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_y_continuous(name = "Percent of LWBS") +
geom_text(size = 3, color = "black", aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25)
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")/n(),2), .groups = 'drop') %>%
ggplot(aes(x=factor(AcuteLv), y=percent, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_text(size = 3, color = "black", aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25) +
scale_y_continuous(name = "Percent of LWBS") +
scale_fill_brewer(palette="BuGn") +
scale_x_discrete(name = "Priority Group")
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")*100/n(),2), .groups = 'drop') %>%
ggplot(aes(x=factor(AcuteLv), y=percent, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_text(size = 3, color = "black", aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25) +
scale_y_continuous(name = "Percent of LWBS (%)") +
scale_fill_brewer(palette="BuGn") +
scale_x_discrete(name = "Priority Group") +
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), hjust=-0.5, size = 2) +
theme_minimal()
# Mean Satisfaction Score by Priority Group across Methods
df_p %>% group_by(AcuteLv, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(x=factor(AcuteLv), y=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_y_continuous(name = "Mean Satisfaction Score") +
scale_x_discrete(name = "Priority Group") +
geom_text(size = 3, color = 'black', aes(label=mean_SF),
position=position_dodge(width=0.9), vjust=-0.25)+
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9), hjust=-0.5, size = 2) +
theme_minimal()
# Mean Satisfaction Score by Day across Methods
df_p %>% group_by(Day_C, Method) %>% filter(Time_A != "TBD") %>%
summarise(mean_SF = round(mean(SF_Score),2)) %>%
ggplot(aes(y=factor(Day_C), x=mean_SF, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_fill_brewer(palette="BuGn") +
scale_x_continuous(name = "Mean Satisfaction Score") +
scale_y_discrete(name = "Day") +
geom_text(aes(label=mean_SF), position=position_dodge(width=0.9),
hjust=-0.5, size = 2, color="black") +
theme_minimal()
# Compare the % of LWBS in each Priority Group across method
# Percent calculation method: within each AcuteLv,
# LWBS/all patients with the same AcuteLv
df_p %>% group_by(AcuteLv, Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")*100/n(),2), .groups = 'drop') %>%
ggplot(aes(x=factor(AcuteLv), y=percent, fill=Method)) +
geom_bar(stat="identity", position=position_dodge()) +
geom_text(size = 2.5, color = "black", aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25) +
scale_y_continuous(name = "Percent of LWBS (%)") +
scale_fill_brewer(palette="BuGn") +
scale_x_discrete(name = "Priority Group") +
theme_minimal()
# Compare the % of LWBS in each method
df_p %>% group_by(Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")*100/n(),2),
.groups = 'drop') %>%
ggplot(aes(x=Method, y=percent)) +
geom_col(width = 0.5, fill="mint") +
scale_y_continuous(name = "Percent of LWBS") +
scale_x_discrete(name = "Method") +
geom_text(size = 3, aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25) +
theme_minimal()
# Compare the % of LWBS in each method
df_p %>% group_by(Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")*100/n(),2),
.groups = 'drop') %>%
ggplot(aes(x=Method, y=percent)) +
geom_col(width = 0.5, fill="lightgreen") +
scale_y_continuous(name = "Percent of LWBS") +
scale_x_discrete(name = "Method") +
geom_text(size = 3, aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25) +
theme_minimal()
# Compare the % of LWBS in each method
df_p %>% group_by(Method) %>%
summarise(percent = round(sum(Time_A == "LWBS")*100/n(),2),
.groups = 'drop') %>%
ggplot(aes(x=Method, y=percent)) +
geom_col(width = 0.5, fill="steelblue") +
scale_y_continuous(name = "Percent of LWBS") +
scale_x_discrete(name = "Method") +
geom_text(size = 3, aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.25) +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
# Import files each experiment set
df_er_3a <- read.csv('~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3A/Processed/df_er.csv')
df_er_3b <- read.csv('~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3B/Processed/df_er.csv')
df_er_3c <- read.csv('~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Processed/df_er.csv')
df_p_3a <- read.csv('~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3A/Processed/df_p.csv')
df_p_3b <- read.csv('~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3B/Processed/df_p.csv')
df_p_3c <- read.csv('~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Processed/df_p.csv')
# Add column
df_er_3a <- df_er_3a %>% mutate(Overcrowding = "High")
df_er_3b <- df_er_3b %>% mutate(Overcrowding = "Medium")
df_er_3c <- df_er_3c %>% mutate(Overcrowding = "Low")
df_p_3a <- df_p_3a %>% mutate(Overcrowding = "High")
df_p_3b <- df_p_3b %>% mutate(Overcrowding = "Medium")
df_p_3c <- df_p_3c %>% mutate(Overcrowding = "Low")
# Combine files
df_er_3 <- rbind(df_er_3a, df_er_3b, df_er_3c)
df_p_3 <- rbind(df_p_3a, df_p_3b, df_p_3c)
# Reorder
df_er_3 <- df_er_3 %>% mutate(Overcrowding = fct_relevel(Overcrowding, "High", "Medium", "Low"))
df_p_3 <- df_p_3 %>% mutate(Overcrowding = fct_relevel(Overcrowding, "High", "Medium", "Low"))
# Wait Time by Priority Group
ggplot(df_p_3, aes(y=Total_Wait_Time, x=Method)) +
geom_violin() +
facet_grid(vars(Overcrowding)) +
scale_y_continuous(name = "Wait Time") +
scale_x_discrete(name = "Method") +
labs(title = 'Distribution of Wait Time across Methods',
caption = "Result of 100 simulations") +
theme_bw() +
theme(plot.title=element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.background=element_blank())
# Compare the % of LWBS in each method
df_p_3 %>% group_by(Method, Overcrowding) %>%
summarise(percent = round(sum(Time_A == "LWBS")*100/n(),2),
.groups = 'drop') %>%
ggplot(aes(x=Method, y=percent, fill = Overcrowding)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_y_continuous(name = "Percent of LWBS (%)") +
scale_x_discrete(name = "Method") +
scale_fill_brewer(palette = "Blues", direction=-1) +
geom_text(size = 2.5, color = "black", aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.8) +
labs(title = 'The Percentage of LWBS over All Visited Patients',
subtitle = 'Across Methods and Overcrowding level',
caption = "Result of 100 simulations",
fill = "Overcrowding Level") +
theme_minimal() +
theme(plot.title=element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5))
knitr::opts_chunk$set(echo = TRUE)
# Compare the % of LWBS in each method
df_p_3 %>% group_by(Method, Overcrowding) %>%
summarise(percent = round(sum(Time_A == "LWBS")*100/n(),2),
.groups = 'drop') %>%
ggplot(aes(x=Method, y=percent, fill = Overcrowding)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_y_continuous(name = "Percent of LWBS (%)") +
scale_x_discrete(name = "Method") +
scale_fill_brewer(palette = "Blues", direction=-1) +
geom_text(size = 2.5, color = "black", aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.8) +
labs(title = 'The Percentage of LWBS over All Visited Patients',
subtitle = 'Across Methods and Overcrowding Levels',
caption = "Result of 100 simulations",
fill = "Overcrowding Level") +
theme_minimal() +
theme(plot.title=element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5))
library(dplyr)
library(tidyverse)
# Wait Time by Priority Group
ggplot(df_p_3, aes(y=Total_Wait_Time, x=Method)) +
geom_violin() +
facet_grid(vars(Overcrowding)) +
scale_y_continuous(name = "Wait Time") +
scale_x_discrete(name = "Method") +
labs(title = 'Distribution of Wait Time across Methods',
caption = "Result of 100 simulations") +
theme_bw() +
theme(plot.title=element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.background=element_blank())
# Compare the % of LWBS in each method
df_p_3 %>% group_by(Method, Overcrowding) %>%
summarise(percent = round(sum(Time_A == "LWBS")*100/n(),2),
.groups = 'drop') %>%
ggplot(aes(x=Method, y=percent, fill = Overcrowding)) +
geom_bar(stat="identity", position=position_dodge()) +
scale_y_continuous(name = "Percent of LWBS (%)") +
scale_x_discrete(name = "Method") +
scale_fill_brewer(palette = "Blues", direction=-1) +
geom_text(size = 2.5, color = "black", aes(label=percent),
position=position_dodge(width=0.9), vjust=-0.8) +
labs(title = 'The Percentage of LWBS over All Visited Patients',
subtitle = 'Across Methods and Overcrowding Levels',
caption = "Result of 100 simulations",
fill = "Overcrowding Level") +
theme_minimal() +
theme(plot.title=element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5))
