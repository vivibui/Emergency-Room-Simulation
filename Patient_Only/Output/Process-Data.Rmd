---
title: "Process-Data"
author: "Vivian Bui"
date: "2023-02-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{R}
library(dplyr)
library(tidyverse)
library(fs) 
```

NOTE: Before running the program 
1. Check path names in 
    (a) CREATE_FILES
    (b) EXPORT_FILES
2. Check dataset names in 
    (a) EXPORT_FILES
    (b) CREATE_COPY
    (c) MERGE 
3. In EXPORT_FILES, create an empty "Processed" folder in the designated path 

```{R, results='hide', message=FALSE, warning=FALSE}

############# CREATE FILES #############

# Create function 
create_file <- function(dir){
  # Get file path 
  file_paths <- fs::dir_ls(dir)
  #Initiate 
  file_contents <- list() 
  # Read file from path 
  for (i in seq_along(file_paths)){
    file_contents[[i]] <- read.table(file_paths[[i]], header=T)}
  # Merge file
  return (file_contents %>% map(as_tibble) %>% reduce(full_join)) }

# Run function 
df_er_c1 <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/C1/EmergencyRoom")
df_er_c2 <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/C2/EmergencyRoom")
df_er_fifo <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/FIFO/EmergencyRoom")
df_er_a1pp <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/A1-PP/EmergencyRoom")
df_er_a2pq <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/A2-PQ/EmergencyRoom")
df_er_z1pq <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Z1-PQ/EmergencyRoom")
df_er_z2pq <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Z2-PQ/EmergencyRoom")
df_er_z3q <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Z3-Q/EmergencyRoom")


df_p_c1 <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/C1/PatientList")
df_p_c2 <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/C2/PatientList")
df_p_fifo <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/FIFO/PatientList") 
df_p_a1pp <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/A1-PP/PatientList")
df_p_a2pq <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/A2-PQ/PatientList")
df_p_z1pq <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Z1-PQ/PatientList")
df_p_z2pq <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Z2-PQ/PatientList")
df_p_z3q <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Z3-Q/PatientList")

df_sf_c1 <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/C1/Satisfaction")
df_sf_c2 <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/C2/Satisfaction")
df_sf_fifo <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/FIFO/Satisfaction")
df_sf_a1pp <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/A1-PP/Satisfaction")
df_sf_a2pq <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/A2-PQ/Satisfaction")
df_sf_z1pq <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Z1-PQ/Satisfaction")
df_sf_z2pq <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Z2-PQ/Satisfaction")
df_sf_z3q <- create_file("~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Z3-Q/Satisfaction")
```


```{R, results='hide', message=FALSE, warning=FALSE}

############# EXPORT FILES #############

# Create Function 
main_path = "~/Desktop/Emergency-Room-Simulation/Patient_Only/Output/3C/Processed"
export_file <- function(df, path) {
  write.csv(df, path, row.names=FALSE)
}

# Export files to designated directory 
export_file(df_er_c1, paste(main_path, "df_er_c1.csv", sep="/"))
export_file(df_er_c2, paste(main_path, "df_er_c2.csv", sep="/"))
export_file(df_er_fifo, paste(main_path, "df_er_fifo.csv", sep="/"))
export_file(df_er_a1pp, paste(main_path, "df_er_a1pp.csv", sep="/"))
export_file(df_er_a2pq, paste(main_path, "df_er_a2pq.csv", sep="/"))
export_file(df_er_z1pq, paste(main_path, "df_er_z1pq.csv", sep="/"))
export_file(df_er_z2pq, paste(main_path, "df_er_z2pq.csv", sep="/"))
export_file(df_er_z3q, paste(main_path, "df_er_z3q.csv", sep="/"))

export_file(df_p_c1, paste(main_path, "df_p_c1.csv", sep="/"))
export_file(df_p_c2, paste(main_path, "df_p_c2.csv", sep="/"))
export_file(df_p_fifo, paste(main_path, "df_p_fifo.csv", sep="/"))
export_file(df_p_a1pp, paste(main_path, "df_p_a1pp.csv", sep="/"))
export_file(df_p_a2pq, paste(main_path, "df_p_a2pq.csv", sep="/"))
export_file(df_p_z1pq, paste(main_path, "df_p_z1pq.csv", sep="/"))
export_file(df_p_z2pq, paste(main_path, "df_p_z2pq.csv", sep="/"))
export_file(df_p_z3q, paste(main_path, "df_p_z3q.csv", sep="/"))

export_file(df_sf_c1, paste(main_path, "df_sf_c1.csv", sep="/"))
export_file(df_sf_c2, paste(main_path, "df_sf_c2.csv", sep="/"))
export_file(df_sf_fifo, paste(main_path, "df_sf_fifo.csv", sep="/"))
export_file(df_sf_a1pp, paste(main_path, "df_sf_a1pp.csv", sep="/"))
export_file(df_sf_a2pq, paste(main_path, "df_sf_a2pq.csv", sep="/"))
export_file(df_sf_z1pq, paste(main_path, "df_sf_z1pq.csv", sep="/"))
export_file(df_sf_z2pq, paste(main_path, "df_sf_z2pq.csv", sep="/"))
export_file(df_sf_z3q, paste(main_path, "df_sf_z3q.csv", sep="/"))

```


```{R, results='hide', message=FALSE, warning=FALSE}

############# CREATE COPY #############

df_er_c1_copy <- df_er_c1
df_er_c2_copy <- df_er_c2
df_er_fifo_copy <- df_er_fifo
df_er_a1pp_copy <- df_er_a1pp
df_er_a2pq_copy <- df_er_a2pq
df_er_z1pq_copy <- df_er_z1pq
df_er_z2pq_copy <- df_er_z2pq
df_er_z3q_copy <- df_er_z3q


df_p_c1_copy <- df_p_c1
df_p_c2_copy <- df_p_c2
df_p_fifo_copy <- df_p_fifo
df_p_a1pp_copy <- df_p_a1pp
df_p_a2pq_copy <- df_p_a2pq
df_p_z1pq_copy <- df_p_z1pq
df_p_z2pq_copy <- df_p_z2pq
df_p_z3q_copy <- df_p_z3q


df_sf_c1_copy <- df_sf_c1
df_sf_c2_copy <- df_sf_c2
df_sf_fifo_copy <- df_sf_fifo
df_sf_a1pp_copy <- df_sf_a1pp
df_sf_a2pq_copy <- df_sf_a2pq
df_sf_z1pq_copy <- df_sf_z1pq
df_sf_z2pq_copy <- df_sf_z2pq
df_sf_z3q_copy <- df_sf_z3q

```


```{R, results='hide', message=FALSE, warning=FALSE}

############# MERGE #############

# Add method column 
df_er_c1_copy <- df_er_c1_copy %>% mutate(Method = "C1") 
df_er_c2_copy <- df_er_c2_copy %>% mutate(Method = "C2") 
df_er_fifo_copy <- df_er_fifo_copy %>% mutate(Method = "FIFO")
df_er_a1pp_copy <- df_er_a1pp_copy %>% mutate(Method = "A1-PP")
df_er_a2pq_copy <- df_er_a2pq_copy %>% mutate(Method = "A2-PQ")
df_er_z1pq_copy <- df_er_z1pq_copy %>% mutate(Method = "Z1-PQ")
df_er_z2pq_copy <- df_er_z2pq_copy %>% mutate(Method = "Z2-PQ")
df_er_z3q_copy <- df_er_z3q_copy %>% mutate(Method = "Z3-Q")

df_p_c1_copy <- df_p_c1_copy %>% mutate(Method = "C1") 
df_p_c2_copy <- df_p_c2_copy %>% mutate(Method = "C2") 
df_p_fifo_copy <- df_p_fifo_copy %>% mutate(Method = "FIFO")
df_p_a1pp_copy <- df_p_a1pp_copy %>% mutate(Method = "A1-PP")
df_p_a2pq_copy <- df_p_a2pq_copy %>% mutate(Method = "A2-PQ")
df_p_z1pq_copy <- df_p_z1pq_copy %>% mutate(Method = "Z1-PQ")
df_p_z2pq_copy <- df_p_z2pq_copy %>% mutate(Method = "Z2-PQ")
df_p_z3q_copy <- df_p_z3q_copy %>% mutate(Method = "Z3-Q")

# Merge
df_er <- rbind(df_er_c1_copy, df_er_c2_copy, df_er_fifo_copy,
            df_er_a1pp_copy, df_er_a2pq_copy, df_er_z1pq_copy,
            df_er_z2pq_copy, df_er_z3q_copy)


df_p <- rbind(df_p_c1_copy, df_p_c2_copy, df_p_fifo_copy,
            df_p_a1pp_copy, df_p_a2pq_copy, df_p_z1pq_copy,
            df_p_z2pq_copy, df_p_z3q_copy)

```


```{R, results='hide', message=FALSE, warning=FALSE}

############# EXPORT FILES #############

export_file(df_er, paste(main_path, "df_er.csv", sep="/"))
export_file(df_p, paste(main_path, "df_p.csv", sep="/"))

```




